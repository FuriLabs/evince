From: Alexander Mikhaylenko <alexm@gnome.org>
Date: Wed, 5 Jan 2022 23:24:22 +0500
Subject: application: Support dark style preference

(cherry picked from commit 36f935f48d10ba0cbeb4066e076c432359e90dac)
---
 meson.build            | 7 ++++++-
 shell/ev-application.c | 2 ++
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/meson.build b/meson.build
index 0bb5d0f..338165a 100644
--- a/meson.build
+++ b/meson.build
@@ -4,6 +4,11 @@ project(
   license: 'GPL2+',
   default_options: 'buildtype=debugoptimized',
   meson_version: '>= 0.53.0',
+  default_options: [
+    'libhandy:vapi=false',
+    'libhandy:introspection=disabled',
+    'libhandy:tests=false',
+  ]
 )
 
 if get_option('development')
@@ -150,7 +155,7 @@ top_inc = include_directories('.')
 
 glib_req_version = '>= 2.44.0'
 gtk_req_version = '>= 3.22.0'
-hdy_req_version = '>= 1.0.0'
+hdy_req_version = '>= 1.5.0'
 
 gdk_pixbuf_dep = dependency('gdk-pixbuf-2.0', version: '>= 2.40.0')
 config_h.set_quoted('EXTRA_GDK_PIXBUF_LOADERS_DIR',
diff --git a/shell/ev-application.c b/shell/ev-application.c
index e704bda..7a1b1b7 100644
--- a/shell/ev-application.c
+++ b/shell/ev-application.c
@@ -998,6 +998,8 @@ ev_application_startup (GApplication *gapplication)
         G_APPLICATION_CLASS (ev_application_parent_class)->startup (gapplication);
 
         hdy_init ();
+        hdy_style_manager_set_color_scheme (hdy_style_manager_get_default (),
+                                            HDY_COLOR_SCHEME_PREFER_LIGHT);
 
         for (it = action_accels; it[0]; it += g_strv_length ((gchar **)it) + 1)
                 gtk_application_set_accels_for_action (GTK_APPLICATION (application), it[0], &it[1]);
